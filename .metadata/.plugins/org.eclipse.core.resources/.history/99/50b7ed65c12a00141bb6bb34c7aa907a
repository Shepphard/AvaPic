package mp.edu.hs.trier.de.view.maincontainers.change.elements;

import java.awt.Component;
import java.awt.FlowLayout;
import java.awt.Graphics;
import java.awt.GridLayout;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.BorderFactory;
import javax.swing.Icon;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JCheckBox;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.border.Border;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

import mp.edu.hs.trier.de.controller.parameters.ParameterController;
import mp.edu.hs.trier.de.model.IShapeModelChanged;
import mp.edu.hs.trier.de.model.ShapeModel;
import mp.edu.hs.trier.de.view.maincontainers.change.elements.color.ColorRectangle;

@SuppressWarnings("serial")
public class ChangeColor extends JPanel implements ActionListener, IShapeModelChanged, ChangeListener{

	private ShapeModel model;
	private JButton fillButton;
	private JButton strokeButton;
	private ParameterController pCont;
	
	private JCheckBox fillBox;
	private JCheckBox strokeBox;
	
	public ChangeColor(ShapeModel model, ParameterController pCont)
	{
		this.model = model;
		this.pCont = pCont;
		
		JPanel panel = new JPanel(new GridLayout(2,2));
		
		ImageIcon img = new ImageIcon("img/color.png");
		
		setLayout(new FlowLayout());
		
//		Border lineBorder = BorderFactory.createTitledBorder("Color Settings");
//		setBorder(lineBorder);
		
		
		
		//COLOR PART
		ColorRectangle strokeCol = new ColorRectangle(model, true);
		ColorRectangle fillCol = new ColorRectangle(model, false);
		
		model.addListener(strokeCol);
		model.addListener(fillCol);
		
		strokeButton = new JButton("Set Stroke Color");
		strokeButton.setActionCommand("stroke");
		strokeButton.addActionListener(this);
		
		fillButton = new JButton("Set Fill Color");
		fillButton.setActionCommand("fill");
		fillButton.addActionListener(this);
		
		updateFillStrok();
		//END COLOR PART
		
		fillBox = new JCheckBox("Filled");
		fillBox.setActionCommand("fill");
		fillBox.addChangeListener(this);
		
		strokeBox = new JCheckBox("Stroke");
		strokeBox.setActionCommand("stroke");
		strokeBox.addChangeListener(this);
		
		strokeChanged();
		fillChanged();
		
		add(fillBox);
		
		add(strokeBox);
		
		
		panel.add(strokeButton);
		panel.add(strokeCol);
		panel.add(strokeBox);
		
		panel.add(fillButton);
		panel.add(fillCol);
		panel.add(strokeBox);
		
		add(new JLabel(img));
		add(panel);
	}

	@Override
	public void actionPerformed(ActionEvent e) {
		if(e.getActionCommand().equals("stroke"))
			new ChangeColorChooser(model, true, pCont);
		else
			new ChangeColorChooser(model, false, pCont);
		
	}


	private void updateFillStrok()
	{
		if(model.isFilled())
			fillButton.setEnabled(true);
		else
			fillButton.setEnabled(false);
		
		if(model.isStroke())
			strokeButton.setEnabled(true);
		else
			strokeButton.setEnabled(false);
	}
	
	@Override
	public void shapeChanged() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void rotationChanged() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void strokeChanged() {
		updateFillStrok();
		updateBoxes();
		
	}

	@Override
	public void fillChanged() {
		updateFillStrok();
		updateBoxes();
		
	}

	@Override
	public void sizeChanged() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void stateChanged(ChangeEvent e) {
		JCheckBox box = (JCheckBox)e.getSource();
		if(box.isSelected() == true)
			if(box.getActionCommand().equals("stroke"))
				pCont.setStroked(true);
			else
				pCont.setFilled(true);
		else
			if(box.getActionCommand().equals("stroke"))
				pCont.setStroked(false);
			else
				pCont.setFilled(false);
		
	}
	
	private void updateBoxes()
	{
		if(model.isStroke())
		{
			strokeBox.setSelected(true);
			
			if(model.isFilled())
				strokeBox.setEnabled(true);
			else
				strokeBox.setEnabled(false);
		}
		else
		{
			strokeBox.setSelected(false);
		}
		
		if(model.isFilled())
		{
			fillBox.setSelected(true);
			
			if(model.isStroke())
				fillBox.setEnabled(true);
			else
				fillBox.setEnabled(false);
		}
		else
		{
			fillBox.setSelected(false);
			
			if(model.isStroke())
				fillBox.setEnabled(true);
			else
				fillBox.setEnabled(false);
		}
	}
}
